(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13942,        411]
NotebookOptionsPosition[     12854,        371]
NotebookOutlinePosition[     13207,        387]
CellTagsIndexPosition[     13164,        384]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"r", ",", "\[Nu]", ",", "l", ",", "n"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", "=", "197.327"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mass", "=", "858.6661665717603"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h2m2", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["hbar", "2"], "/", 
    RowBox[{"(", 
     RowBox[{"2", "mass"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Nu]", "=", 
   RowBox[{"mass", "*", 
    RowBox[{"\[Omega]", "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "hbar"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.773721553379712*^9, 3.773721635077355*^9}, {
  3.773722285466984*^9, 3.773722286271039*^9}, {3.7737226183705473`*^9, 
  3.773722628169338*^9}, {3.7737227188151493`*^9, 3.77372271901505*^9}, {
  3.773722803422604*^9, 3.773722803799082*^9}, {3.773722907909086*^9, 
  3.773722908616687*^9}, {3.773723263553331*^9, 3.773723280475587*^9}, {
  3.7759109643907747`*^9, 3.7759109649914227`*^9}, {3.775911006972885*^9, 
  3.775911007076076*^9}, {3.775911109283024*^9, 3.7759111220171328`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"No", "[", 
    RowBox[{"n_", ",", "l_", ",", "\[Nu]_"}], "]"}], ":=", 
   SqrtBox[
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{"2", 
        SuperscriptBox["\[Nu]", "3"]}], "\[Pi]"]], 
     FractionBox[
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"n", "+", 
         RowBox[{"2", "l"}], "+", "3"}]], 
       RowBox[{"n", "!"}], 
       SuperscriptBox["\[Nu]", "l"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "+", 
         RowBox[{"2", "l"}], "+", "1"}], ")"}], "!!"}]]}]]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"No", "[", 
      RowBox[{"n_", ",", "l_", ",", "\[Nu]_"}], "]"}], "=", "1"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi", "[", 
    RowBox[{"r_", ",", "n_", ",", "l_", ",", "\[Nu]_"}], "]"}], ":=", 
   RowBox[{"r", " ", 
    RowBox[{"No", "[", 
     RowBox[{"n", ",", "l", ",", "\[Nu]"}], "]"}], " ", 
    SuperscriptBox["r", "l"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Nu]"}], " ", 
      SuperscriptBox["r", "2"]}]], 
    RowBox[{"LaguerreL", "[", 
     RowBox[{"n", ",", 
      RowBox[{"l", "+", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"2", "\[Nu]", " ", 
       SuperscriptBox["r", "2"]}]}], "]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddpsi", "[", 
   RowBox[{"r_", ",", "n_", ",", "l_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Psi", "[", 
        RowBox[{"r", ",", "n", ",", "l", ",", "\[Nu]"}], "]"}], ",", "r"}], 
      "]"}], ",", "r"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", "r_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "mass", " ", 
   SuperscriptBox[
    RowBox[{"\[Omega]", " "}], "2"], 
   SuperscriptBox["r", "2"]}]}]}], "Input",
 CellChangeTimes->{{3.773570150280923*^9, 3.773570171233405*^9}, {
   3.773570215082209*^9, 3.7735702816336927`*^9}, {3.773570974042946*^9, 
   3.773571125950055*^9}, 3.773571237064639*^9, {3.77372150501999*^9, 
   3.773721505270545*^9}, 3.7737215453999653`*^9, {3.773721666412022*^9, 
   3.773721690305496*^9}, {3.7737219419551277`*^9, 3.773721942570126*^9}, {
   3.773722017472987*^9, 3.7737220398468323`*^9}, {3.773722213681704*^9, 
   3.773722214194601*^9}, {3.773722518110622*^9, 3.773722566147615*^9}, {
   3.7737235177728033`*^9, 3.773723520395562*^9}, {3.7737236945148907`*^9, 
   3.7737236965173817`*^9}, {3.774009492849566*^9, 3.774009493439136*^9}, {
   3.774009533113233*^9, 3.7740095332379723`*^9}}],

Cell["\[LineSeparator]\[LineSeparator]\[LineSeparator]Integral tests:", "Text",
 CellChangeTimes->{{3.775911054693598*^9, 3.775911061569828*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"l", "\[IndentingNewLine]", "\[Nu]", "\[IndentingNewLine]", \
"mass", "\[IndentingNewLine]", "h2m2"}], "Input",
 CellChangeTimes->{{3.7759110698960323`*^9, 3.775911080101686*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.775911076002489*^9, 3.775911080888072*^9}, 
   3.775911143927533*^9}],

Cell[BoxData["2.175744238172577`"], "Output",
 CellChangeTimes->{{3.775911076002489*^9, 3.775911080888072*^9}, 
   3.775911143945512*^9}],

Cell[BoxData["858.6661665717603`"], "Output",
 CellChangeTimes->{{3.775911076002489*^9, 3.775911080888072*^9}, 
   3.7759111439582167`*^9}],

Cell[BoxData["22.673505982226143`"], "Output",
 CellChangeTimes->{{3.775911076002489*^9, 3.775911080888072*^9}, 
   3.775911143975848*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vhyiama", "[", 
   RowBox[{"rr_", ",", "rl_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "0.3706"}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.1808"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "+", "rl"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{"0.4013", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "-", "rl"}], ")"}], "^", "2"}]}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "12.94"}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.1808"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "+", "rl"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{"0.9633", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "-", "rl"}], ")"}], "^", "2"}]}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "331.2"}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.1808"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "+", "rl"}], ")"}], "^", "2"}]}], "-", 
      RowBox[{"2.930", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rr", "-", "rl"}], ")"}], "^", "2"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.775909033675867*^9, 3.775909095346298*^9}, {
  3.775910849343192*^9, 3.7759108590619307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vlocal", "[", "rr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "17.49"}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.2752"}], "*", 
       RowBox[{"r", "^", "2"}]}], ")"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "127.0"}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.4559"}], "*", 
       RowBox[{"r", "^", "2"}]}], ")"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", "497.8", ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.6123"}], "*", 
       RowBox[{"r", "^", "2"}]}], ")"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.775911352524654*^9, 3.7759114027951183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vl", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Psi", "[", 
      RowBox[{"t", ",", "n1", ",", "l", ",", "\[Nu]"}], "]"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "16"}], 
       SuperscriptBox["t", "2"]}]], 
     RowBox[{"Psi", "[", 
      RowBox[{"t", ",", "n2", ",", "l", ",", "\[Nu]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0.01", ",", "\[Infinity]"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7757944118851347`*^9, 3.7757944451417503`*^9}, {
  3.775794598996439*^9, 3.775794604885006*^9}, {3.775794699440057*^9, 
  3.7757947386712008`*^9}, {3.775794785339025*^9, 3.7757947923739433`*^9}, {
  3.775794848093505*^9, 3.7757948487751217`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     SuperscriptBox["t", "2"]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0.0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.775896262199744*^9, 3.775896272329344*^9}, {
  3.775896364498444*^9, 3.775896374665111*^9}, {3.775896522713773*^9, 
  3.775896524888137*^9}, {3.7758965555385857`*^9, 3.775896556298687*^9}, {
  3.7758968266709747`*^9, 3.7758968304320927`*^9}}],

Cell[BoxData["0.886226925452758`"], "Output",
 CellChangeTimes->{
  3.77589627302627*^9, {3.7758963718789787`*^9, 3.775896374931452*^9}, 
   3.77589652545722*^9, 3.775896567226679*^9, 3.77589683409836*^9, 
   3.7758970116562443`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vnl", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Psi", "[", 
      RowBox[{"t", ",", "n1", ",", "l", ",", "\[Nu]"}], "]"}], 
     RowBox[{"Vhyiama", "[", 
      RowBox[{"t", ",", "t1"}], "]"}], 
     RowBox[{"Psi", "[", 
      RowBox[{"t1", ",", "n2", ",", "l", ",", "\[Nu]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0.0", ",", "rmax"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t1", ",", "0.0", ",", "rmax"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Vnl", "[", 
     RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"t", "+", "t1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0.0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "0.0", ",", "2"}], "}"}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.775795931933894*^9, 3.775795954167108*^9}, 
   3.775818968163106*^9, {3.775890062927947*^9, 3.775890080124641*^9}, {
   3.775890263493452*^9, 3.775890263785277*^9}, {3.7758905644759827`*^9, 
   3.775890575294176*^9}, {3.7758906379171677`*^9, 3.7758906396362257`*^9}, {
   3.7758906765794153`*^9, 3.7758907172796497`*^9}, {3.775896240155912*^9, 
   3.7758962489051027`*^9}, {3.775896905222107*^9, 3.775896945474051*^9}, {
   3.775896999583543*^9, 3.775897009030006*^9}, {3.775897061033341*^9, 
   3.775897067116355*^9}, {3.775897120829794*^9, 3.775897123333208*^9}, {
   3.775897765526153*^9, 3.7758977775994043`*^9}, 3.775898516127388*^9, {
   3.775898834785721*^9, 3.77589883885135*^9}, {3.775910827015757*^9, 
   3.775910832534273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.775819610105753*^9, 3.775819619644244*^9}, 
   3.775911066522851*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.775819620029722*^9}],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.775819620042447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rmax", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Vnl", "[", 
  RowBox[{"2", ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7758190112358713`*^9, 3.775819019310727*^9}, {
  3.775819713676488*^9, 3.775819713846591*^9}, {3.7758198149133244`*^9, 
  3.775819815340884*^9}, {3.775823006619339*^9, 3.775823008628282*^9}, {
  3.775890097750332*^9, 3.775890099877928*^9}, {3.7758906191952047`*^9, 
  3.775890620523081*^9}, {3.775897770594186*^9, 3.7758977727591352`*^9}, {
  3.7758985500458527`*^9, 3.775898551332946*^9}, {3.775898840261104*^9, 
  3.775898842259964*^9}}],

Cell[BoxData[
 RowBox[{"-", "35.07124352392085`"}]], "Output",
 CellChangeTimes->{
  3.775819028905405*^9, 3.775819718572311*^9, 3.775819848795611*^9, 
   3.775823030806527*^9, {3.775890555725189*^9, 3.775890583802741*^9}, {
   3.7758906215664663`*^9, 3.775890645549592*^9}, 3.775890682501753*^9, 
   3.775890719524044*^9, {3.77589693815108*^9, 3.7758969493445807`*^9}, 
   3.775897023411207*^9, 3.775897071095365*^9, 3.775897127051175*^9, 
   3.7758977845902777`*^9, 3.7758981376563387`*^9, 3.775898518989581*^9, 
   3.7758985518896227`*^9, 3.775898842698707*^9, 3.775899581991255*^9, {
   3.775910842069644*^9, 3.775910861735786*^9}}]
}, Open  ]]
},
WindowSize->{617, 755},
WindowMargins->{{0, Automatic}, {Automatic, -1}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1405, 34, 169, "Input"],
Cell[1966, 56, 2712, 76, 201, "Input"],
Cell[4681, 134, 145, 1, 87, "Text"],
Cell[CellGroupData[{
Cell[4851, 139, 193, 2, 80, "Input"],
Cell[5047, 143, 120, 2, 28, "Output"],
Cell[5170, 147, 137, 2, 28, "Output"],
Cell[5310, 151, 139, 2, 28, "Output"],
Cell[5452, 155, 138, 2, 28, "Output"]
}, Open  ]],
Cell[5605, 160, 1459, 49, 80, "Input"],
Cell[7067, 211, 810, 27, 46, "Input"],
Cell[7880, 240, 825, 21, 70, "Input"],
Cell[CellGroupData[{
Cell[8730, 265, 490, 11, 35, "Input"],
Cell[9223, 278, 233, 4, 28, "Output"]
}, Open  ]],
Cell[9471, 285, 1768, 42, 80, "Input"],
Cell[CellGroupData[{
Cell[11264, 331, 118, 2, 28, "Input"],
Cell[11385, 335, 70, 1, 28, "Output"],
Cell[11458, 338, 90, 2, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11585, 345, 614, 11, 46, "Input"],
Cell[12202, 358, 636, 10, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
