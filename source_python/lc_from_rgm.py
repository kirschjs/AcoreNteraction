import os
import math
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import shutil
import imp
from matplotlib import cm, colorbar, colors
from matplotlib.ticker import FormatStrFormatter
from matplotlib.collections import LineCollection

import rad_interpolation

colors = [
    '#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b',
    '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'
]

datadir = "/home/kirscher/kette_repo/AcoreNteraction/data/"

MeVfm = 197.3161329

# a = 0.025 * A^(1/3)
lc = {
    'B2=1_B3=4_ac=0.025': [[6, 1.100], [7, 1.300], [8, 1.500], [9, 1.700], [
        10, 1.900
    ], [11, 2.200], [12, 2.400], [13, 2.600], [14, 2.900], [15, 3.100], [
        16, 3.300
    ], [17, 3.600], [18, 3.800], [19, 4.000], [20, 4.300], [21, 4.500], [
        22, 4.700
    ], [23, 4.900], [24, 5.200], [25, 5.400], [26, 5.600], [27, 5.800], [
        28, 5.900
    ], [29, 6.100], [30, 6.300], [31, 6.400], [32, 6.600], [33, 6.700], [
        34, 6.900
    ], [35, 7.000], [36, 7.000], [37, 7.100], [38, 7.200], [39, 7.300], [
        40, 7.400
    ], [41, 7.500], [42, 7.500], [43, 7.600], [44, 7.600], [45, 7.600], [
        46, 7.600
    ], [47, 7.700], [48, 7.700], [49, 7.700], [50, 7.700], [51, 7.700],
                           [52, 7.800], [53, 7.800], [54, 7.800], [55, 7.800],
                           [56, 7.900], [57, 7.900], [58, 7.900], [59, 7.900]],
    'B2=1_B3=3_ac=0.025':
    [[5, 0.800], [6, 1.000], [7, 1.200], [8, 1.400], [9, 1.600], [10, 1.800], [
        11, 2.100
    ], [12, 2.300], [13, 2.500], [14, 2.700], [15, 2.900], [16, 3.100], [
        17, 3.300
    ], [18, 3.500], [19, 3.700], [20, 3.800], [21, 4.000], [22, 4.100], [
        23, 4.300
    ], [24, 4.400], [25, 4.500], [26, 4.600], [27, 4.700], [28, 4.800], [
        29, 4.800
    ], [30, 4.900], [31, 5.000], [32, 5.000], [33, 5.000], [34, 5.000], [
        35, 5.000
    ], [36, 5.000], [37, 5.000], [38, 5.000], [39, 5.000], [40, 5.000], [
        41, 5.000
    ], [42, 5.000], [43, 5.000], [44, 5.000], [45, 5.000], [46, 5.000],
     [47, 5.000], [48, 5.000], [49, 5.000], [50, 5.000], [51, 5.000],
     [52, 5.000], [53, 4.800], [54, 4.800], [55, 4.800], [56, 4.800],
     [57, 4.800], [58, 4.800], [59, 4.700]],
    'B2=1_B3=1.5_ac=0.001':
    [[5, 0.300], [6, 0.400], [7, 0.400], [8, 0.500], [9, 0.500], [10, 0.600], [
        11, 0.600
    ], [12, 0.600], [13, 0.700], [14, 0.700], [15, 0.800], [16, 0.800], [
        17, 0.900
    ], [18, 0.900], [19, 1.000], [20, 1.000], [21, 1.100], [22, 1.100], [
        23, 1.200
    ], [24, 1.200], [25, 1.300], [26, 1.300], [27, 1.300], [28, 1.400], [
        29, 1.400
    ], [30, 1.500], [31, 1.500], [32, 1.600], [33, 1.600], [34, 1.700], [
        35, 1.700
    ], [36, 1.800], [37, 1.800], [38, 1.900], [39, 1.900], [40, 2.000], [
        41, 2.000
    ], [42, 2.000], [43, 2.200], [44, 2.200], [45, 2.200], [46, 2.200],
     [47, 2.300], [48, 2.300], [49, 2.300], [50, 2.300], [51, 2.500],
     [52, 2.500], [53, 2.500], [54, 2.500], [55, 2.500], [56, 2.600],
     [57, 2.600], [58, 2.600], [59, 2.600]],
    'B2=1_B3=1.5_ac=0.0005': [[6, 0.300], [7, 0.300], [8, 0.300], [9, 0.400], [
        10, 0.400
    ], [11, 0.400], [12, 0.400], [13, 0.500], [14, 0.500], [15, 0.500], [
        16, 0.600
    ], [17, 0.600], [18, 0.600], [19, 0.700], [20, 0.700], [21, 0.700], [
        22, 0.700
    ], [23, 0.800], [24, 0.800], [25, 0.800], [26, 0.900], [27, 0.900], [
        28, 0.900
    ], [29, 1.000], [30, 1.000], [31, 1.000], [32, 1.100], [33, 1.100], [
        34, 1.100
    ], [35, 1.200], [36, 1.200], [37, 1.200], [38, 1.300], [39, 1.300], [
        40, 1.300
    ], [41, 1.400], [42, 1.400], [43, 1.400], [44, 1.500], [45, 1.500], [
        46, 1.500
    ], [47, 1.500], [48, 1.600], [49, 1.600], [50, 1.600], [51, 1.700], [
        52, 1.700
    ], [53, 1.800], [54, 1.800], [55, 1.800], [56, 1.900], [57, 1.900],
                              [58, 1.900], [59, 1.900]],
    'B2=1_B3=3_ac=0.015': [[5, 0.700], [6, 0.900], [7, 1.000], [8, 1.200], [
        9, 1.400
    ], [10, 1.600], [11, 1.700], [12, 1.900], [13, 2.100], [14, 2.300], [
        15, 2.500
    ], [16, 2.600], [17, 2.800], [18, 3.000], [19, 3.200], [20, 3.400], [
        21, 3.500
    ], [22, 3.700], [23, 3.900], [24, 4.000], [25, 4.200], [26, 4.300], [
        27, 4.500
    ], [28, 4.600], [29, 4.700], [30, 4.800], [31, 5.000], [32, 5.100], [
        33, 5.100
    ], [34, 5.300], [35, 5.300], [36, 5.500], [37, 5.500], [38, 5.500], [
        39, 5.500
    ], [40, 5.600], [41, 5.600], [42, 5.600], [43, 5.700], [44, 5.700], [
        45, 5.700
    ], [46, 5.700], [47, 5.700], [48, 5.800], [49, 5.800], [50, 5.800], [
        51, 5.800
    ], [52, 5.800], [53, 5.800], [54, 5.800], [55, 5.800], [56, 5.800], [
        57, 5.800
    ], [58, 5.800], [59, 5.800], [60, 5.800], [61, 5.800], [62, 5.800], [
        63, 5.700
    ], [64, 5.700], [65, 5.700], [66, 5.700], [67, 5.700], [68, 5.700], [
        69, 5.700
    ], [70, 5.700], [71, 5.700], [72, 5.700], [73, 5.600], [74, 5.600], [
        75, 5.600
    ], [76, 5.600], [77, 5.600], [78, 5.600], [79, 5.600], [80, 5.600], [
        81, 5.600
    ], [82, 5.600], [83, 5.600], [84, 5.500], [85, 5.500], [86, 5.500], [
        87, 5.500
    ], [88, 5.500], [89, 5.500], [90, 5.500], [91, 5.500], [92, 5.500], [
        93, 5.500
    ], [94, 5.500], [95, 5.500], [96, 5.500], [97, 5.500], [98, 5.500], [
        99, 5.500
    ], [100, 5.500], [101, 5.500], [102, 5.500], [103, 5.500], [104, 5.500], [
        105, 5.300
    ], [106, 5.300], [107, 5.300], [108, 5.300], [109, 5.300], [110, 5.300], [
        111, 5.300
    ], [112, 5.300], [113, 5.300], [114, 5.300], [115, 5.300], [116, 5.300], [
        117, 5.300
    ], [118, 5.300], [119, 5.300], [120, 5.300], [121, 5.300], [122, 5.300], [
        123, 5.300
    ], [124, 5.100], [125, 5.100], [126, 5.100], [127, 5.100], [128, 5.100], [
        129, 5.100
    ], [130, 5.100], [131, 5.100], [132, 5.100], [133, 5.100], [134, 5.100], [
        135, 5.100
    ], [136, 5.100], [137, 5.100], [138, 5.000], [139, 5.000], [140, 5.000], [
        141, 5.000
    ], [142, 5.000], [143, 5.000], [144, 5.000], [145, 5.000], [146, 5.000],
                           [147, 5.000], [148, 5.000], [149, 5.000]],
    'B2=1_B3=1.5_ac=0.003':
    [[6, 0.50], [7, 0.600], [8, 0.700], [9, 0.800], [10, 0.800], [11, 0.900], [
        12, 1.000
    ], [13, 1.100], [14, 1.100], [15, 1.200], [16, 1.300], [17, 1.400], [
        18, 1.400
    ], [19, 1.500], [20, 1.600], [21, 1.700], [22, 1.700], [23, 1.800], [
        24, 1.800
    ], [25, 1.900], [26, 1.900], [27, 2.000], [28, 2.000], [29, 2.200], [
        30, 2.200
    ], [31, 2.200], [32, 2.200], [33, 2.300], [34, 2.300], [35, 2.300], [
        36, 2.300
    ], [37, 2.300], [38, 2.300], [39, 2.300], [40, 2.300], [41, 2.300], [
        42, 2.300
    ], [43, 2.300], [44, 2.300], [45, 2.300], [46, 2.300], [47, 2.300],
     [48, 2.300], [49, 2.300], [50, 2.300], [51, 2.300], [52,
                                                          2.300], [53, 2.300],
     [54, 2.300], [55, 2.300], [56, 2.300], [57, 2.300], [58,
                                                          2.300], [59, 2.300]],
    'B2=1_B3=1.5_ac=0.0015': [[5, 0.400], [6, 0.400], [7, 0.500], [8, 0.500], [
        9, 0.600
    ], [10, 0.600], [11, 0.700], [12, 0.800], [13, 0.800], [14, 0.900], [
        15, 0.900
    ], [16, 1.000], [17, 1.100], [18, 1.100], [19, 1.200], [20, 1.200], [
        21, 1.300
    ], [22, 1.300], [23, 1.400], [24, 1.500], [25, 1.500], [26, 1.600], [
        27, 1.600
    ], [28, 1.700], [29, 1.700], [30, 1.800], [31, 1.900], [32, 1.900], [
        33, 1.900
    ], [34, 2.000], [35, 2.000], [36, 2.200], [37, 2.200], [38, 2.200], [
        39, 2.300
    ], [40, 2.300], [41, 2.300], [42, 2.300], [43, 2.300], [44, 2.500], [
        45, 2.500
    ], [46, 2.500], [47, 2.500], [48, 2.500], [49, 2.600], [50, 2.600], [
        51, 2.600
    ], [52, 2.600], [53, 2.600], [54, 2.600], [55, 2.600], [56, 2.600], [
        57, 2.600
    ], [58, 2.600], [59, 2.600], [60, 2.600], [61, 2.600], [62, 2.600], [
        63, 2.600
    ], [64, 2.600], [65, 2.600], [66, 2.600], [67, 2.600], [68, 2.600], [
        69, 2.600
    ], [70, 2.600], [71, 2.600], [72, 2.600], [73, 2.600], [74, 2.600], [
        75, 2.600
    ], [76, 2.600], [77, 2.600], [78, 2.600], [79, 2.600], [80, 2.600], [
        81, 2.600
    ], [82, 2.600], [83, 2.600], [84, 2.600], [85, 2.600], [86, 2.600], [
        87, 2.600
    ], [88, 2.600], [89, 2.600], [90, 2.600], [91, 2.600], [92, 2.600], [
        93, 2.600
    ], [94, 2.600], [95, 2.600], [96, 2.600], [97, 2.600], [98, 2.600], [
        99, 2.600
    ], [100, 2.600], [101, 2.600], [102, 2.600], [103, 2.600], [104, 2.600], [
        105, 2.600
    ], [106, 2.600], [107, 2.600], [108, 2.600], [109, 2.600], [110, 2.600], [
        111, 2.600
    ], [112, 2.600], [113, 2.600], [114, 2.600], [115, 2.600], [116, 2.600], [
        117, 2.600
    ], [118, 2.600], [119, 2.600], [120, 2.600], [121, 2.600], [122, 2.600], [
        123, 2.600
    ], [124, 2.600], [125, 2.600], [126, 2.600], [127, 2.600], [128, 2.600], [
        129, 2.600
    ], [130, 2.600], [131, 2.600], [132, 2.600], [133, 2.600], [134, 2.600], [
        135, 2.600
    ], [136, 2.600], [137, 2.600], [138, 2.600], [139, 2.600], [140, 2.600], [
        141, 2.600
    ], [142, 2.600], [143, 2.600], [144, 2.600], [145, 2.600], [146, 2.600],
                              [147, 2.600], [148, 2.600], [149, 2.600]]
}

data = [line for line in open(datadir + 'lc4_from_rgm_3-30.dat')][1:]
anz = len(data[0].strip().split()) - 1

f = plt.figure(figsize=(10, 8), dpi=95)
f.suptitle(r'$local$', fontsize=14)

ax1 = f.add_subplot(111)

ax1.set_xlabel(r'$A$', fontsize=12)
ax1.set_ylabel(r'$\lambda_c\;[fm^{-1}]$', fontsize=12)

ax1.plot(
    [float(line.strip().split()[0]) for line in data],
    np.array([float(line.strip().split()[1]) for line in data]),
    label=r'$(SVM) B(3)=4MeV$',
    c=colors[3],
    ls='-',
    lw=2)

for key in lc.keys():
    ax1.plot(
        [aa[0] for aa in lc[key]], [aa[1] for aa in lc[key]],
        label=r'$B(3)=%4.1f\,MeV\;,\;\; a_{core}=%4.4f\cdot A^{1/3}$' %
        (float(key.split('=')[2].split('_')[0]), float(key.split('=')[3])),
        ls=':')
# Shrink current axis by 20%
box = ax1.get_position()
ax1.set_position([box.x0, box.y0, box.width, box.height * 0.8])

plt.legend(
    loc='upper center',
    ncol=2,
    numpoints=1,
    fontsize=10,
    bbox_to_anchor=(0.5, 1.3))

strFile = 'lc_vgl.pdf'
if os.path.isfile(strFile):
    os.remove(strFile)
plt.savefig(strFile)
plt.savefig(strFile)